/**
 * skylark-lightgallery - The skylark album widgets.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["skylark-jquery","../light-gallery"],function(e,o){"use strict";var i={videoMaxWidth:"855px",autoplayFirstVideo:!0,youtubePlayerParams:!1,vimeoPlayerParams:!1,dailymotionPlayerParams:!1,vkPlayerParams:!1,videojs:!1,videojsOptions:{}},l=function(o){return this.core=e(o).data("lightGallery"),this.$el=e(o),this.core.s=e.extend({},i,this.core.s),this.videoLoaded=!1,this.init(),this};l.prototype.init=function(){var o=this;o.core.$el.on("hasVideo.lg.tm",function(e,o,i,l){var t=this;if(t.core.$slide.eq(o).find(".lg-video").append(t.loadVideo(i,"lg-object",!0,o,l)),l)if(t.core.s.videojs)try{videojs(t.core.$slide.eq(o).find(".lg-html5").get(0),t.core.s.videojsOptions,function(){!t.videoLoaded&&t.core.s.autoplayFirstVideo&&this.play()})}catch(e){console.error("lightGallery:- Make sure you have included videojs")}else!t.videoLoaded&&t.core.s.autoplayFirstVideo&&t.core.$slide.eq(o).find(".lg-html5").get(0).play()}.bind(this)),o.core.$el.on("onAferAppendSlide.lg.tm",function(e,o){var i=this.core.$slide.eq(o).find(".lg-video-cont");i.hasClass("lg-has-iframe")||(i.css("max-width",this.core.s.videoMaxWidth),this.videoLoaded=!0)}.bind(this)),o.core.doCss()&&o.core.$items.length>1&&(o.core.s.enableSwipe||o.core.s.enableDrag)?o.core.$el.on("onSlideClick.lg.tm",function(){var e=o.core.$slide.eq(o.core.index);o.loadVideoOnclick(e)}):o.core.$slide.on("click.lg",function(){o.loadVideoOnclick(e(this))}),o.core.$el.on("onBeforeSlide.lg.tm",function(o,i,l){var t,a=this.core.$slide.eq(i),s=a.find(".lg-youtube").get(0),r=a.find(".lg-vimeo").get(0),d=a.find(".lg-dailymotion").get(0),c=a.find(".lg-vk").get(0),n=a.find(".lg-html5").get(0);if(s)s.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");else if(r)try{new Vimeo.Player(r).pause().catch(function(e){console.error("Unable to pause the video:",e.name)})}catch(e){console.warn("lightGallery:- Make sure you have included https://github.com/vimeo/player.js")}else if(d)d.contentWindow.postMessage("pause","*");else if(n)if(this.core.s.videojs)try{videojs(n).pause()}catch(e){console.error("lightGallery:- Make sure you have included videojs")}else n.pause();c&&e(c).attr("src",e(c).attr("src").replace("&autoplay","&noplay"));t=this.core.s.dynamic?this.core.s.dynamicEl[l].src:this.core.$items.eq(l).attr("href")||this.core.$items.eq(l).attr("data-src");var h=this.core.isVideo(t,l)||{};(h.youtube||h.vimeo||h.dailymotion||h.vk)&&this.core.$outer.addClass("lg-hide-download")}.bind(this)),o.core.$el.on("onAfterSlide.lg.tm",function(e,i){o.core.$slide.eq(i).removeClass("lg-video-playing")}),o.core.s.autoplayFirstVideo&&o.core.$el.on("onAferAppendSlide.lg.tm",function(e,i){if(!o.core.lGalleryOn){var l=o.core.$slide.eq(i);setTimeout(function(){o.loadVideoOnclick(l)},100)}})},l.prototype.loadVideo=function(o,i,l,t,a){var s,r="",d=1,c="",n=this.core.isVideo(o,t)||{};if(s=(s=this.core.s.dynamic?this.core.s.dynamicEl[this.core.index].title:this.core.$items.eq(this.core.index).attr("title")||this.core.$items.eq(this.core.index).find("img").first().attr("alt"))?'title="'+s+'"':"",l&&(d=this.videoLoaded?0:this.core.s.autoplayFirstVideo?1:0),n.youtube)c="?wmode=opaque&autoplay="+d+"&enablejsapi=1",this.core.s.youtubePlayerParams&&(c=c+"&"+e.param(this.core.s.youtubePlayerParams)),r='<iframe allow="autoplay" class="lg-video-object lg-youtube '+i+'" '+s+' width="560" height="315" src="//www.youtube.com/embed/'+n.youtube[1]+c+'" frameborder="0" allowfullscreen></iframe>';else if(n.vimeo)c="?autoplay="+d,this.core.s.vimeoPlayerParams&&(c=c+"&"+e.param(this.core.s.vimeoPlayerParams)),r='<iframe allow="autoplay" class="lg-video-object lg-vimeo '+i+'" '+s+' width="560" height="315"  src="//player.vimeo.com/video/'+n.vimeo[1]+c+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';else if(n.dailymotion)c="?wmode=opaque&autoplay="+d+"&api=postMessage",this.core.s.dailymotionPlayerParams&&(c=c+"&"+e.param(this.core.s.dailymotionPlayerParams)),r='<iframe allow="autoplay" class="lg-video-object lg-dailymotion '+i+'" '+s+' width="560" height="315" src="//www.dailymotion.com/embed/video/'+n.dailymotion[1]+c+'" frameborder="0" allowfullscreen></iframe>';else if(n.html5){var h=a.substring(0,1);"."!==h&&"#"!==h||(a=e(a).html()),r=a}else n.vk&&(c="&autoplay="+d,this.core.s.vkPlayerParams&&(c=c+"&"+e.param(this.core.s.vkPlayerParams)),r='<iframe allow="autoplay" class="lg-video-object lg-vk '+i+'" '+s+' width="560" height="315" src="//vk.com/video_ext.php?'+n.vk[1]+c+'" frameborder="0" allowfullscreen></iframe>');return r},l.prototype.loadVideoOnclick=function(e){var o=this;if(e.find(".lg-object").hasClass("lg-has-poster")&&e.find(".lg-object").is(":visible"))if(e.hasClass("lg-has-video")){var i=e.find(".lg-youtube").get(0),l=e.find(".lg-vimeo").get(0),t=e.find(".lg-dailymotion").get(0),a=e.find(".lg-html5").get(0);if(i)i.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*");else if(l)try{new Vimeo.Player(l).play().catch(function(e){console.error("error playing the video:",e.name)})}catch(e){console.warn("lightGallery:- Make sure you have included https://github.com/vimeo/player.js")}else if(t)t.contentWindow.postMessage("play","*");else if(a)if(o.core.s.videojs)try{videojs(a).play()}catch(e){console.error("lightGallery:- Make sure you have included videojs")}else a.play();e.addClass("lg-video-playing")}else{e.addClass("lg-video-playing lg-has-video");var s=function(i,l){if(e.find(".lg-video").append(o.loadVideo(i,"",!1,o.core.index,l)),l)if(o.core.s.videojs)try{videojs(o.core.$slide.eq(o.core.index).find(".lg-html5").get(0),o.core.s.videojsOptions,function(){this.play()})}catch(e){console.error("lightGallery:- Make sure you have included videojs")}else o.core.$slide.eq(o.core.index).find(".lg-html5").get(0).play()};o.core.s.dynamic?s(o.core.s.dynamicEl[o.core.index].src,o.core.s.dynamicEl[o.core.index].html):s(o.core.$items.eq(o.core.index).attr("href")||o.core.$items.eq(o.core.index).attr("data-src"),o.core.$items.eq(o.core.index).attr("data-html"));var r=e.find(".lg-object");e.find(".lg-video").append(r),e.find(".lg-video-object").hasClass("lg-html5")||(e.removeClass("lg-complete"),e.find(".lg-video-object").on("load.lg error.lg",function(){e.addClass("lg-complete")}))}},l.prototype.destroy=function(){this.videoLoaded=!1},e.fn.lightGallery.modules.video=l});
//# sourceMappingURL=../sourcemaps/modules/video.js.map
