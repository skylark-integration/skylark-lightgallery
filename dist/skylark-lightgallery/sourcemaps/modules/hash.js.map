{"version":3,"sources":["modules/hash.js"],"names":["define","$","lightGallery","defaults","hash","Hash","element","this","core","data","s","extend","oldHash","window","location","init","prototype","_hash","_this","$el","on","event","prevIndex","index","history","replaceState","pathname","search","galleryId","_idx","parseInt","split","indexOf","slide","lGalleryOn","destroy","document","title","off","fn","modules"],"mappings":";;;;;;;AAAAA,QACI,iBACA,oBACF,SAASC,EAAEC,GAET,aAEA,IAAIC,GACAC,MAAM,GAGNC,EAAO,SAASC,GAWhB,OATAC,KAAKC,KAAOP,EAAEK,GAASG,KAAK,gBAE5BF,KAAKC,KAAKE,EAAIT,EAAEU,UAAWR,EAAUI,KAAKC,KAAKE,GAE3CH,KAAKC,KAAKE,EAAEN,OACZG,KAAKK,QAAUC,OAAOC,SAASV,KAC/BG,KAAKQ,QAGFR,MAGXF,EAAKW,UAAUD,KAAO,WAClB,IACIE,EADAC,EAAQX,KAIZW,EAAMV,KAAKW,IAAIC,GAAG,qBAAsB,SAASC,EAAOC,EAAWC,GAC3DC,QAAQC,aACRD,QAAQC,aAAa,KAAM,KAAMZ,OAAOC,SAASY,SAAWb,OAAOC,SAASa,OAAS,OAAST,EAAMV,KAAKE,EAAEkB,UAAY,UAAYL,GAEnIV,OAAOC,SAASV,KAAO,MAAQc,EAAMV,KAAKE,EAAEkB,UAAY,UAAYL,IAK5EtB,EAAEY,QAAQO,GAAG,qBAAsB,WAC/BH,EAAQJ,OAAOC,SAASV,KACxB,IAAIyB,EAAOC,SAASb,EAAMc,MAAM,WAAW,GAAI,IAG1Cd,EAAMe,QAAQ,MAAQd,EAAMV,KAAKE,EAAEkB,YAAc,EAClDV,EAAMV,KAAKyB,MAAMJ,GAAM,GAAO,GACvBX,EAAMV,KAAK0B,YAClBhB,EAAMV,KAAK2B,aAMvB9B,EAAKW,UAAUmB,QAAU,WAEhB5B,KAAKC,KAAKE,EAAEN,OAKbG,KAAKK,SAAWL,KAAKK,QAAQoB,QAAQ,MAAQzB,KAAKC,KAAKE,EAAEkB,WAAa,EAClEJ,QAAQC,aACRD,QAAQC,aAAa,KAAM,KAAMlB,KAAKK,SAEtCC,OAAOC,SAASV,KAAOG,KAAKK,QAG5BY,QAAQC,aACRD,QAAQC,aAAa,KAAMW,SAASC,MAAOxB,OAAOC,SAASY,SAAWb,OAAOC,SAASa,QAEtFd,OAAOC,SAASV,KAAO,GAI/BG,KAAKC,KAAKW,IAAImB,IAAI,cAItBrC,EAAEsC,GAAGrC,aAAasC,QAAQpC,KAAOC","file":"../../modules/hash.js","sourcesContent":["define([\n    \"skylark-jquery\",\n    \"../light-gallery\"\n],function($,lightGallery){\n\n    'use strict';\n\n    var defaults = {\n        hash: true\n    };\n\n    var Hash = function(element) {\n\n        this.core = $(element).data('lightGallery');\n\n        this.core.s = $.extend({}, defaults, this.core.s);\n\n        if (this.core.s.hash) {\n            this.oldHash = window.location.hash;\n            this.init();\n        }\n\n        return this;\n    };\n\n    Hash.prototype.init = function() {\n        var _this = this;\n        var _hash;\n\n        // Change hash value on after each slide transition\n        _this.core.$el.on('onAfterSlide.lg.tm', function(event, prevIndex, index) {\n            if (history.replaceState) {\n                history.replaceState(null, null, window.location.pathname + window.location.search + '#lg=' + _this.core.s.galleryId + '&slide=' + index);\n            } else {\n                window.location.hash = 'lg=' + _this.core.s.galleryId + '&slide=' + index;\n            }\n        });\n\n        // Listen hash change and change the slide according to slide value\n        $(window).on('hashchange.lg.hash', function() {\n            _hash = window.location.hash;\n            var _idx = parseInt(_hash.split('&slide=')[1], 10);\n\n            // it galleryId doesn't exist in the url close the gallery\n            if ((_hash.indexOf('lg=' + _this.core.s.galleryId) > -1)) {\n                _this.core.slide(_idx, false, false);\n            } else if (_this.core.lGalleryOn) {\n                _this.core.destroy();\n            }\n\n        });\n    };\n\n    Hash.prototype.destroy = function() {\n\n        if (!this.core.s.hash) {\n            return;\n        }\n\n        // Reset to old hash value\n        if (this.oldHash && this.oldHash.indexOf('lg=' + this.core.s.galleryId) < 0) {\n            if (history.replaceState) {\n                history.replaceState(null, null, this.oldHash);\n            } else {\n                window.location.hash = this.oldHash;\n            }\n        } else {\n            if (history.replaceState) {\n                history.replaceState(null, document.title, window.location.pathname + window.location.search);\n            } else {\n                window.location.hash = '';\n            }\n        }\n\n        this.core.$el.off('.lg.hash');\n\n    };\n\n    $.fn.lightGallery.modules.hash = Hash;\n\n});"]}